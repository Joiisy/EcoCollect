<!-- Menú lateral -->
<ion-menu contentId="main-content">
  <ion-header>
    <ion-toolbar class="menu-toolbar">
      <ion-title>Menú Conductor</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content class="menu-content">
    <ion-list>


  
      <ion-item (click)="logout()" button class="logout-item">
        <ion-icon name="log-out-outline" slot="start"></ion-icon>
        <ion-label>Cerrar Sesión</ion-label>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>

<!-- Contenido principal -->
<div class="ion-page" id="main-content">
  <ion-header [translucent]="true">
    <ion-toolbar class="modern-toolbar">
      <ion-buttons slot="start">
        <ion-menu-button auto-hide="false"></ion-menu-button>
      </ion-buttons>
      <ion-title>Conductores - Recorrido</ion-title>
      <ion-buttons slot="end">
        <ion-button >
          <ion-icon slot="icon-only" name="notifications-outline"></ion-icon>
        </ion-button>
        <ion-button>
          <ion-icon slot="icon-only" name="person-circle-outline"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>

  <ion-content [fullscreen]="true" class="modern-content">
    <!-- Header Collapse -->
    <ion-header collapse="condense">
      <ion-toolbar class="modern-toolbar">
        <ion-title size="large">Conductores</ion-title>
      </ion-toolbar>
    </ion-header>

    <!-- Resto del contenido -->
    <div class="vehicle-card" *ngIf="vehiculoSeleccionado">
      <div class="vehicle-info">
        <ion-icon name="car-sport" class="vehicle-icon"></ion-icon>
        <div class="vehicle-details">
          <span class="vehicle-name">{{ vehiculoSeleccionado.marca }} - {{ vehiculoSeleccionado.placa }}</span>
          <span class="status-badge" [class.active]="modoRecorrido">
            {{ modoRecorrido ? 'En recorrido' : 'Disponible' }}
          </span>
        </div>
      </div>
    </div>

    <div class="map-section">
      <div class="map-header">
        <h3>{{ rutaSeleccionada?.nombre_ruta || 'Selecciona una ruta' }}</h3>
        <span class="paradas-count" *ngIf="rutaSeleccionada">
          {{ puntosRutaActual?.length || 0 }} paradas
        </span>
      </div>
      <div id="mapId" class="map-container"></div>
    </div>

    <div class="controls-section">
      <div class="select-item">
        <div class="select-header">
          <ion-icon name="map-outline"></ion-icon>
          <span>Ruta de viaje</span>
        </div>
        <ion-select 
          placeholder="Selecciona una ruta" 
          (ionChange)="seleccionarRuta($event)" 
          interface="action-sheet"
          class="modern-select">
          <ion-select-option *ngFor="let ruta of rutasGuardadas" [value]="ruta.id">
            {{ ruta.nombre_ruta }}
          </ion-select-option>
        </ion-select>
      </div>

      <div class="select-item">
        <div class="select-header">
          <ion-icon name="car-sport-outline"></ion-icon>
          <span>Vehículo asignado</span>
        </div>
        <ion-select 
          (ionChange)="seleccionarVehiculo($event)" 
          placeholder="Selecciona un vehículo" 
          interface="action-sheet"
          class="modern-select">
          <ion-select-option *ngFor="let vehiculo of vehiculo" [value]="vehiculo.id">
            {{ vehiculo.marca }} - {{ vehiculo.placa }}
          </ion-select-option>
        </ion-select>
      </div>

      <ion-button 
        color="success"
        class="main-btn" 
        expand="block" 
        (click)="toggleRecorridoMode()" 
        [disabled]="!rutaSeleccionada"
        [class.recorriendo]="modoRecorrido">
        <ion-icon [name]="modoRecorrido ? 'stop-circle' : 'play-circle'" slot="start"></ion-icon>
        {{ modoRecorrido ? 'Detener Recorrido' : 'Iniciar Recorrido' }}
        <ion-badge *ngIf="modoRecorrido" class="live-badge">LIVE</ion-badge>
      </ion-button>
    </div>

    <div *ngIf="modoRecorrido" class="progress-section">
      <div class="progress-card">
        <div class="progress-header">
          <h4>
            <ion-icon name="navigate"></ion-icon>
            Recorrido en progreso
          </h4>
          <span class="percent">{{ ((indicePuntoActual / puntosRutaActual.length) * 100).toFixed(0) }}%</span>
        </div>
        
        <div class="progress-stats">
          <span class="route-name">{{ rutaSeleccionada?.nombre_ruta }}</span>
          <span class="route-count">{{ indicePuntoActual + 1 }}/{{ puntosRutaActual.length }} puntos</span>
        </div>

        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="(indicePuntoActual / puntosRutaActual.length) * 100"></div>
        </div>
      </div>
    </div>

    <div class="info-section" *ngIf="!modoRecorrido">
      <div class="info-card">
        <ion-icon name="information-circle"></ion-icon>
        <div class="info-text">
          <h4>Listo para comenzar</h4>
          <p>Selecciona una ruta y un vehículo para iniciar tu recorrido</p>
        </div>
      </div>
    </div>
  </ion-content>
</div>